<!DOCTYPE html>
<html lang="en-GB">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/vue"></script>
    <script src="https://unpkg.com/vue-router"></script>
    <title>Beam | Admin</title>
</head>
<body>
<div id="app" style="margin-top: 50px;">
    <nav style="background-color: lightskyblue;">
        <div>
            <ul>
                <li> <router-link event = "mouseover" to="/" id = "Home"> Home </router-link> </li>
                <li> <router-link event = "mouseover" to="student" id = "Student"> Student </router-link> </li>
                <li> <router-link event = "mouseover" to="lecturer" id = "Lecturer"> Lecturer </router-link> </li>
                <li> <router-link event = "mouseover" to="modules" id = "Module"> Module </router-link> </li>
                <li> <router-link event = "mouseover" to="plan" id = "Academic Plan"> Academic Plan </router-link> </li>
                <li> <router-link event = "mouseover" to="record" id = "Attendance Record"> Attendance Record </router-link> </li>
                <li> <router-link event = "mouseover" to="timetable" id = "Timetable"> Timetable </router-link> </li>
                <li> <router-link event = "mouseover" to="lm" id = "lm"> Lecture's Module </router-link> </li>
                <li><input type = "button" onclick="logOut()" id = "logout" value ="Log Out"></li>
            </ul>
        </div>
    </nav>

    <div style="margin-top: 20px;">
        <router-view></router-view>
    </div>
</div>
<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/7.24.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.24.0/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.24.0/firebase-database.js"></script>
<!-- Connecting to Firebase Realtime Database -->
<script>
    var config = {
        apiKey: "AIzaSyBmrrr9ShVMaeS4aNV6gdK52fovQnLd1eA",
        authDomain: "beam-5845a.firebaseapp.com",
        databaseURL: "https://beam-5845a.firebaseio.com",
        projectId: "beam-5845a",
        storageBucket: "beam-5845a.appspot.com",
        messagingSenderId: "77499735722",
        appId: "1:77499735722:web:bfd8be3df0080bee077ad3",
        measurementId: "G-XKPK4PNM7W"
    };
    firebase.initializeApp(config);
</script>
<!-- Referencing the components to respective template -->
<script>
    var Home = {
        template: "#home-template"
    };
    var Student = {
        template: "#student-template"
    };
    var Lecturer = {
        template: "#lecturer-template"
    };
    var Modules = {
        template: "#module-template"
    };
    var Timetable = {
        template: "#timetable-template"
    };
    var Plan = {
        template: "#plan-template"
    };
    var Record = {
        template: "#record-template"
    };
    var lecture_module = {
        template: "#lm-template"
    };
    var NotFound = {
        template: "#notfound-template"
    };
</script>
<!-- Routing paths for navigation bar -->
<script>
    var routes = [
        { path: '/', component: Home},
        { path: '/student', component: Student },
        { path: '/lecturer', component: Lecturer },
        { path: '/modules', component: Modules },
        { path: '/plan', component: Plan },
        { path: '/record', component: Record },
        { path: '/timetable', component: Timetable },
        { path: '/lm', component: lecture_module }
    ];

    var router = new VueRouter({
        routes: routes,
        mode: 'history',
        base: '/'
    });
    
    var app = new Vue({
        el: '#app',
        router: router,
    }).$mount('#app')
</script>
<!-- Home Template -->
<script type="text/x-template" id="home-template">
    <div><h1>Home</h1><p>This is BEAM Home.</p></div>
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<!-- Student Template -->
<script type="text/x-template" id="student-template">
    <div><h1>Student Registration</h1>
        <label for="fName">First Name:</label>
        <input type="text" id = "fName" placeholder="First Name"><br>
        <label for="lName">Last Name:</label>
        <input type="text" id = "lName" placeholder="Last Name"><br>
        <label for="lName">Programme:</label>
        <input type="text" id = "programme" placeholder="Programme"><br>
        <label for="email">Email:</label>
        <input type="email" id = "email" placeholder="Email">
        <label for="password">Password:</label>
        <input type="password" id = "password" placeholder="Password">
        <input type = "button" onclick="writeStudentData()" id = "submit" value ="Submit">
    </div>
</script>
<!-- Write data on Student -->
<script>
    function writeStudentData() {
        var fName = document.getElementById("fName");
        var lName = document.getElementById("lName");
        var programme = document.getElementById("programme");
        var email = document.getElementById("email");
        var password = document.getElementById("password");
        const promise = firebase.auth().createUserWithEmailAndPassword(email.value, password.value);
        promise.catch(e => alert(e.message));
        var student = {
            FirstName: fName.value,
            LastName: lName.value,
            Programme: programme.value,
            Email: email.value,
            uid: 2
        };

        writeUserData(student);
    };
    function writeUserData(user) {
        firebase.database().ref("student/" + user.uid).set(user).catch(error => {
            console.log(error.message)
        });
    };
<!-- change programme based on career -->
    var $career = $( '#career' ),
        $programme = $( '#programme' ),
        $options = $programme.find( 'programme' );

    $career.on( 'change', function() {
        $programme.html( $options.filter( '[value="' + this.value + '"]' ) );
    } ).trigger( 'change' );
</script>
<!-- Lecturer Template -->
<script type="text/x-template" id="lecturer-template">
    <div><h1>Lecturer Registration</h1>
        <label for="LfName">First Name:</label>
        <input type="text" id = "LfName" placeholder="First Name"><br>
        <label for="LlName">Last Name:</label>
        <input type="text" id = "LlName" placeholder="Last Name"><br>
        <label for="position">Choose a position:</label>
        <select id="position" name="position">
            <option value="Assistant Professor">Assistant Professor</option>
            <option value="Associate Professor">Associate Professor</option>
            <option value="Professor">Professor</option>
        </select><br>
        <label for="faculty">Choose a faculty:</label>
        <select id="faculty" name="faculty">
            <option value="Computer Science">Computer Science</option>
            <option value="Business">Business</option>
            <option value="Engineering">Engineering</option>
        </select><br>
        <label for="Lemail">Email:</label>
        <input type="email" id = "Lemail" placeholder="Email">
        <label for="Lpassword">Password:</label>
        <input type="password" id = "Lpassword" placeholder="Password">
        <input type = "button" onclick="writeLecturerData()" id = "Lsubmit" value ="Submit">
    </div>
</script>
<!-- Write data on Lecturer -->
<script>
    function writeLecturerData() {
        var fName = document.getElementById("LfName");
        var lName = document.getElementById("LlName");
        var position = document.getElementById("position");
        var faculty = document.getElementById("faculty");
        var email = document.getElementById("Lemail");
        var password = document.getElementById("Lpassword");
        const promise = firebase.auth().createUserWithEmailAndPassword(email.value, password.value);
        promise.catch(e => alert(e.message));
        var lecturer = {
            FirstName: fName.value,
            LastName: lName.value,
            Position: position.value,
            Faculty: faculty.value,
            Email: email.value,
            uid: 3
        };

        writeUserData1(lecturer);
    };
    function writeUserData1(user) {
        firebase.database().ref("lecturer/" + user.uid).set(user).catch(error => {
            console.log(error.message)
        });
    };
</script>
<!-- Modules Component -->
<script type="text/x-template" id="module-template">
    <div><h1>Update Module Information</h1>
        <label for="mID">Module ID:</label>
        <input type="text" id = "mID" placeholder="Module ID"><br>
        <label for="Mname">Module Name:</label>
        <input type="text" id = "Mname" placeholder="Module Name"><br>
        <label for="number">Number of Students:</label>
        <input type="number" id = "number" placeholder="Number of Students"><br>
        <!-- Lecturers teaching the module should be here -->
        <input type = "button" onclick="writeModulesData()" id = "Msubmit" value ="Submit">
    </div>
</script>
<!-- Write data on Modules -->
<script>
    function writeModulesData() {
        var mID = document.getElementById("mID");
        var Mname = document.getElementById("Mname");
        var number = document.getElementById("number");
        var modules = {
            Mname: Mname.value,
            number: number,
            mid: mID.value
        };

        writeUserData2(modules);
    };
    function writeUserData2(user) {
        firebase.database().ref("modules/" + user.mid).set(user).catch(error => {
            console.log(error.message)
        });
    };
</script>
<!-- Timetable Component -->
<script type="text/x-template" id="timetable-template">
    <div><h1>Update Timetable</h1>
        <label for="day">Choose a day:</label>
        <select id="day" name="day">
            <option value="monday">Monday</option>
            <option value="tuesday">Tuesday</option>
            <option value="wednesday">Wednesday</option>
            <option value="thursday">Thursday</option>
            <option value="friday">Friday</option>
        </select><br>
        <label for="time">Choose a time (start):</label>
        <select id="time" name="time">
            <option value="0900">0900</option>
            <option value="1000">1000</option>
            <option value="1100">1100</option>
            <option value="1200">1200</option>
            <option value="1300">1300</option>
            <option value="1400">1400</option>
            <option value="1500">1500</option>
            <option value="1500">1600</option>
            <option value="1500">1700</option>
        </select><br>
        <label for="module_id">Module ID:</label>
        <input type="module_id" id = "module_id" placeholder="Module ID">
        <input type = "button" onclick="writeTimetableData()" id = "Tsubmit" value ="Submit">
    </div>
</script>
<!-- Write data on Timetable -->
<script>
    function writeTimetableData() {
        var day = document.getElementById("day");
        var time = document.getElementById("time");
        var module_id = document.getElementById("module_id");
        var timetable = {
            day: day.value,
            time: time.value,
            module_id: module_id
        };

        writeUserData3(timetable);
    };
    function writeUserData3(user) {
        firebase.database().ref("timetable/" + user.day + "/" + user.time).set(user).catch(error => {
            console.log(error.message)
        });
    };
</script>
<!-- Plan Component -->
<script type="text/x-template" id="plan-template">
    <div><h1>Update Academic Plan</h1>
        <label for="plan">Academic Plan:</label>
        <input type="text" id = "plan" placeholder="Academic Plan"><br>
        <label for="Pmodule">Module ID:</label>
        <input type="text" id = "Pmodule" placeholder="Module ID"><br>
        </select><br>
            <input type = "button" onclick="writePlanData()" id = "Psubmit" value ="Submit">
    </div>
</script>
<!-- Write data on Plan -->
<script>
    function writePlanData() {
        var plan = document.getElementById("plan");
        var Pmodule = document.getElementById("Pmodule");
        var plans = {
            plan: plan.value,
            Pmodule: Pmodule.value,
        };
        writeUserData4(plans);
    };
    function writeUserData4(user) {
        firebase.database().ref("plan/" + user.plan + "/" + user.Pmodule).set(user).catch(error => {
            console.log(error.message)
        });
    };
</script>
<!-- Record Component -->
<script type="text/x-template" id="record-template">
    <div><h1>Create Academic Sessions</h1>
        <label for="moduleID">Module ID:</label>
        <input type="text" id = "moduleID" ><br>
        <label for="session_id">Session ID:</label>
        <input type="text" id = "session_id"><br>
        <input type = "button" onclick="writeRecordData()" id = "Rsubmit" value ="Submit">
    </div>
</script>
<!-- Write data on Record -->
<script>
    function writeRecordData() {
        var moduleID = document.getElementById("moduleID");
        var session_id = document.getElementById("session_id");
        var session = {
            moduleID: moduleID.value,
            session_id: session_id.value
        };

        writeUserData5(session);
    };
    function writeUserData5(user) {
        firebase.database().ref("record/" + user.moduleID + "/" + user.session_id).set(user).catch(error => {
            console.log(error.message)
        });
    };
</script>
<!-- Lecturer_Module Component -->
<script type="text/x-template" id="lm-template">
    <div><h1>Assign Modules to Lecturers</h1>
        <label for="lec">Lecturer ID</label>
        <input type="text" id = "lec" placeholder="Lecturer ID"><br>
        <label for="Lmodule">Module ID:</label>
        <input type="text" id = "Lmodule" placeholder="Module ID"><br>
        </select><br>
        <input type = "button" onclick="writeLMData()" id = "lmsubmit" value ="Submit">
    </div>
</script>
<!-- Write data on Lecturer_Module -->
<script>
    function writeLMData() {
        var lec = document.getElementById("lec");
        var lmodule = document.getElementById("Lmodule");
        var plans = {
            Lecturer_ID: lec.value,
            Module_ID: Lmodule.value,
        };
        writeUserData6(plans);
    };
    function writeUserData6(user) {
        firebase.database().ref("lecturer_module/" + user.Lecturer_ID + "/" + user.Module_ID).set(user).catch(error => {
            console.log(error.message)
        });
    };
</script>
<script type="text/x-template" id="notfound-template">
    <div><h1>404 Not Found. <a href="index.html">Return to Home</a></h1>
    </div>
</script>
<!-- Logout -->
<script>
    function logOut(){
        firebase.auth().signOut();
        window.location.href = 'index.html';
    }
    var user = firebase.auth().currentUser;
    firebase.auth().onAuthStateChanged(function(user) {
        if (user) {
            // User is signed in.
        } else {
            window.location.href = 'index.html';
        }
    });
</script>
</body>
</html>
